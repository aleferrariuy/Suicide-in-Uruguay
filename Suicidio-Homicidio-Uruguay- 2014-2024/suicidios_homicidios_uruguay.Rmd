---
title: "Suicidios vs Homicidios en Uruguay"
author: "Alejandro Ferrari"
date: "2025-09-29"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r echo=FALSE, include=FALSE, message=FALSE}
library(readxl);
library(ggplot2);
library(tidyr);
library(dplyr);
library(corrplot);
```
```{r echo=FALSE, include=FALSE}
nombre_archivo <- "suicidios_homicidios.xlsx"
nombre_hoja <- "sui_hom"

datos_sh <- read_excel(
  path = nombre_archivo,   
  sheet = nombre_hoja)      
```

```{r echo=FALSE}
#print(head(datos_sh))
#print(str(datos_sh))
```

```{r echo=FALSE, include=FALSE}
datos_tidy <- datos_sh %>%
  pivot_longer(
    cols = c(suicidios, homicidios), # Columnas a pivotar
    names_to = "Tipo_Evento",        # Nueva columna para el nombre (Suicidios/Homicidios)
    values_to = "Cantidad"           # Nueva columna para los valores
  )

#print("Estructura de los datos transformados:")
#print(head(datos_tidy))
```
---

## Resumen ejecutivo

El a침o 2024 present칩 una caracter칤stica que llam칩 nuestra atenci칩n: la tasa de suicidios duplicaba a la tasa de homicidios. Dado la sensibilidad e importancia de ambas problem치ticas para el Uruguay, decidimos efectuar un breve estudio buscando analizar estas dos variables en el periodo 2014-2024. Al hacerlo hemos constatado que los suicidios, a침o a a침o, siempre han superado en n칰mero a los homicidios. As칤 mismo en la mayor칤a de los a침os, estos superaron al doble de aquellos en n칰mero. Se intent칩 encontrar una relaci칩n directa entre ambos indicadores bas치ndonos en el hecho de las similitudes en sus curvas de tendencia. Sin embargo no fue posible establecer esta relaci칩n, por lo que se concluye recomendando ampliar la investigaci칩n buscando variables externas a este estudio que puedan estar afectando a cada una o a ambas tasas tan importantes para el bienestar del Uruguay.

## Suicidios en Uruguay, 칰ltima d칠cada

Al comenzar el periodo de estudio en el a침o 2014, Uruguay experimentaba una tasa de suicidios de 17.4 cada 100mil habitantes. Al cierre del periodo de estudio, la tasa era de 21.35 cada 100mil habitantes. Esto se corresponde con un incremento de 1:1.23, es decir un 122.70%. Si bien la tasa de suicidios durante los a침os del periodo en algunos casos subi칩, y en otros baj칩, la tendencia siempre se ha mantenido al alza, siendo los resultados los observados finalmente.

Esto, sume a Uruguay en una gran problem치tica relacionada con la salud mental. Diferentes miradas vinculan al suicidio con el consumo problem치tico de sustancias, problemas de salud mental, e incidencia de factores psicosociales derivados de la evoluci칩n de la econom칤a Uruguaya en los 칰ltimos veinte a침os.

```{r suicidios_uy, echo=FALSE, message=FALSE}
grafico_suicidio <- ggplot(
  data = datos_sh,
  aes(
    x = factor(a침o_def),
    y = sui_tasa_100m,
    group = 1
  )
) +
  geom_text(
    aes(label = sui_tasa_100m), # La etiqueta ser치 el valor de la tasa
    vjust = -1,                 # Mueve la etiqueta verticalmente (arriba del punto). Usa 1 para abajo.
    hjust = 0.5,                # Centra la etiqueta horizontalmente
    size = 3.5,                 # Tama침o del texto (ajustable)
    color = "darkgreen"         # Color del texto (ajustable)
  ) +
    geom_line(color="blue") +
    geom_point(color = "black") +
      labs(
        title = "Suicidio en Uruguay, evoluci칩n anual",
        x = "A침o",
        y = "Tasa cada 100mil/hab"
        #fill = "Tipo de Evento"
      ) +
  scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
  theme_minimal() + # Un tema limpio
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) # Centrar t칤tulo

# Mostrar el gr치fico
print(grafico_suicidio)
```


## Homicidios en Uruguay, 칰ltima d칠cada

Al comenzar el periodo de estudio en el a침o 2014, Uruguay experimentaba una tasa de homicidios de 7.8 cada 100mil habitantes. Al cierre del periodo de estudio, la tasa era de 10.7 cada 100mil habitantes. Esto se corresponde con un incremento de 1:1.37, es decir un 137.18%. Si bien la tasa de homicidios durante los a침os del periodo en algunos casos subi칩, y en otros baj칩, la tendencia siempre se ha mantenido al alza, siendo los resultados los observados finalmente.

En el a침o 2018 se registr칩 un fuerte incremento, llegando a una tasa de 12 cada 100mil habitantes. Otro momento interesante es el periodo 2020-2021, cuando se experimenta la llegada y peor momento de la pandemia de Covid 19. Posteriormente a la misma, la tasa se estaciona con una tendencia m칤nima a la baja.

Esto, refleja un contexto de elevada violencia que Uruguay experimenta, especialmente vinculado con el tr치fico de sustancias ilegales, la existencia de bandas fuertemente armadas, y m칰ltiples ocurrencias de casos de violencia intrafamiliar y o de genero (en especial contra la mujer).


```{r homicidios_uy, echo=FALSE, message=FALSE}
grafico_homicidio <- ggplot(
  data = datos_sh,
  aes(
    x = factor(a침o_def),
    y = hom_rasa_100m,
    group = 1
  )
) +
  geom_text(
    aes(label = hom_rasa_100m), # La etiqueta ser치 el valor de la tasa
    vjust = -1,                 # Mueve la etiqueta verticalmente (arriba del punto). Usa 1 para abajo.
    hjust = 0.5,                # Centra la etiqueta horizontalmente
    size = 3.5,                 # Tama침o del texto (ajustable)
    color = "darkgreen"         # Color del texto (ajustable)
  ) +
  geom_line(color="red") +
  geom_point(color = "black") +
    labs(
    title = "Homicidio en Uruguay, evoluci칩n anual",
    x = "A침o",
    y = "Tasa cada 100mil/hab"
    #fill = "Tipo de Evento"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
  theme_minimal() + # Un tema limpio
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) # Centrar t칤tulo

# Mostrar el gr치fico
print(grafico_homicidio)
```

## Suicidios y Homicidios, comparativa anual

En el a침o 2024 los registros oficiales revelan 764 suicidios y 382 homicidios. A simple vista, lo que casi parece una relaci칩n de 2:1. A partir de esta singularidad, se comparan las cifras de ambas variables entre si, para los a침os desde 2014 a 2024.

```{r comparativa_anual, echo=FALSE, message=FALSE}
datos_con_comparacion <- datos_sh %>%
  mutate(
    # La nueva columna 'suicidio_mayor' ser치 TRUE si la tasa de suicidios es mayor, y FALSE si no lo es.
    suicidio_mayor = sui_tasa_100m > hom_rasa_100m,
    suicidio_mayor_por = sui_tasa_100m / hom_rasa_100m
  )

# Imprimir el resultado para ver la columna booleana a침o por a침o
#print("Comparaci칩n de Tasas A침o a A침o:")
#print(datos_con_comparacion)

#resultado_final <- all(datos_con_comparacion$suicidio_mayor)

#print("-------------------------------------------------------")
#print(paste("쯃a tasa de suicidio es mayor que la de homicidio en TODOS los a침os?"))
#print(resultado_final)

# Crear el gr치fico de la Raz칩n de Tasas a lo largo del tiempo
grafico_razon <- ggplot(
  data = datos_con_comparacion,
  aes(
    x = a침o_def,                   # Eje X: El a침o
    y = suicidio_mayor_por     # Eje Y: La raz칩n (Ratio Suicidios/Homicidios)
  )
) +
  # 1. L칤nea de referencia crucial en Y=1
  geom_hline(
    yintercept = 1,
    linetype = "dashed",       # L칤nea punteada para diferenciarla de los datos
    color = "black",
    #size = 1
  ) +
  
  geom_hline(
    yintercept = 2,
    linetype = "dashed",       # L칤nea punteada para diferenciarla de los datos
    color = "red",
    #size = 1
  ) +
  
  # 2. Capa de puntos (Mejor que barras para una raz칩n, ya que enfatiza el valor exacto)
  geom_point(
    #size = 4, 
    color = "darkblue"
  ) +
  
  # 3. L칤nea de conexi칩n para ver la tendencia de la raz칩n
  geom_line(
    group = 1,                 # Asegurar que se conecten los puntos
    color = "darkblue",
    #size = 1
  ) +
  
  # 4. Etiquetas y personalizaci칩n
  labs(
    title = "Raz칩n Tasa de Suicidios / Tasa de Homicidios por A침o",
    x = "A침o",
    y = "Raz칩n (Ratio Suicidios/Homicidios)",
    subtitle = "Raz칩n > 1 indica tasa de suicidio es mayor | Raz칩n = 2 indica tasa de suicidio duplica"
  ) +
  scale_x_continuous(breaks = unique(datos_con_comparacion$a침o_def)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Mostrar el gr치fico
print(grafico_razon)
```

Como el gr치fico muestra, los valores de ratio por encima de 1 indican un valor mayor de casos de suicidio en relaci칩n con los de homicidio. As칤 tambi칠n, un valor de 2 indica que el n칰mero de casos de suicidio es el doble que el de homicidios. Por encima de 2, supera el doble.

Se concluye que, desde hace diez a침os, en Uruguay el n칰mero de suicidios por a침o, supera al de homicidios, 7 a침os superando el doble de casos, dos a침os por encima de una vez y media el n칰mero de homicidios, y 2 a침os lindando con el doble del n칰mero de homicidios. 

A continuaci칩n una visualizaci칩n de ambos indices comparados en el tiempo (anualmente).

```{r echo=FALSE}
grafico_barras <- ggplot(
  data = datos_tidy, 
  aes(
    x = factor(a침o_def),       # Eje X: Los a침os. 'factor()' asegura que se traten como categor칤as.
    y = Cantidad,          # Eje Y: La cantidad de eventos.
    fill = Tipo_Evento     # Agrupamiento: El color de la barra (fill) agrupa Suicidios y Homicidios.
  )
) +
  # A침adir la capa de barras. 'position = "dodge"' es clave para agruparlas.
  geom_bar(
    stat = "identity",     # Usar los valores exactos de Y, no un conteo.
    position = position_dodge(width = 0.9) # Asegura que las barras est칠n lado a lado
  ) +
  
  # Personalizaci칩n del gr치fico
  labs(
    title = "Comparaci칩n Anual de Suicidios vs. Homicidios",
    x = "A침o",
    y = "N칰mero de Casos",
    fill = "Tipo de Evento"
  ) +
  
  # Ajustar colores y tema para mejor visualizaci칩n
  scale_fill_manual(values = c("homicidios" = "#E69F00", "suicidios" = "#56B4E9")) +
  theme_minimal() + # Un tema limpio
  theme(plot.title = element_text(hjust = 0.5, face = "bold")) # Centrar t칤tulo

# Mostrar el gr치fico
print(grafico_barras)
```

## Tendencia evolutiva del suicidio y el homicidio

Desde el a침o 2014, ambos indicadores presentan una tendencia incremental, con variaciones anuales que no revierten la misma de forma definitiva. Hasta el a침o 2019-2020 la tendencia de ambos indicadores evolucionaba de forma casi paralela, lo que dej칩 de ser as칤 a partir del inicio de la pandemia de Covid 19. En este punto los homicidios han presentado un estacionamiento de su impulso incremental, ya manteniendo dicho comportamiento durante tres a침os.


```{r echo=FALSE, message=FALSE}
grafico_tendencia <- ggplot(
  data = datos_tidy, 
  aes(
    x = a침o_def,
    y = Cantidad,
    color = Tipo_Evento,
    group = Tipo_Evento
  )
) +
  # 1. A침adir las l칤neas y puntos originales
  geom_line(alpha = 0.8) +
  geom_point(color = "black") +
  
  # 2. 游댐 A침adir la l칤nea de tendencia (regresi칩n lineal) 
  # Esto dibuja una l칤nea para cada valor de 'Tipo_Evento' (por el mapeo de color y grupo)
  geom_smooth(
    method = "lm",           # Especifica el m칠todo: 'lm' es Regresi칩n Lineal.
    formula = y ~ x,
    se = TRUE, #FALSE,              # IMPORTANTE: 'se = FALSE' oculta la banda de error est치ndar,
                             # dejando solo la l칤nea de tendencia.
    linetype = "dashed",     # Usamos l칤nea punteada para distinguirla de la l칤nea de datos.
    #size = 1                 # Grosor de la l칤nea
  ) +
  
  # Personalizaci칩n del gr치fico
  labs(
    title = "Tendencia Anual de Suicidios y Homicidios (con Regresi칩n Lineal)",
    x = "A침o",
    y = "N칰mero de Casos",
    color = "Tipo de Evento"
  ) +
  
  # Ajustes de visualizaci칩n
  scale_color_manual(values = c("homicidios" = "red", "suicidios" = "blue")) +
  scale_x_continuous(breaks = unique(datos_tidy$a침o_def)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Mostrar el gr치fico
print(grafico_tendencia)
```

## Correlaci칩n entre suicidio y homicidio

En vista de que con el correr de los a침os el suicidio y el homicidio, en su indicador de ocurrencia de casos, se han incrementado manteniendo una tendencia similar, hemos decidido realizar un estudio de correlaci칩n con el m칠todo Pearson.

El resultado indica entre suicidios y homicidios una correlaci칩n positiva de 0.59 lo que nos hace pensar que, si bien esto demostrar칤a el hecho de que ambas incrementan juntas en el tiempo, no lo estar칤an haciendo por interacci칩n directa, sino por acci칩n de otra variable ajena a este estudio, lo que nos invita a sugerir el trabajar en ampliar la tarea en su b칰squeda.

El homicidio, en relaci칩n con el a침o de defunci칩n, devolvi칩 un indice de correlaci칩n positivo de 0.66, esto muestra que existe el incremento relacionado con el pasar del tiempo, aunque dicho crecimiento hoy es menor.

El suicidio, en relaci칩n con el a침o de defunci칩n, devolvi칩 un indice de correlaci칩n positivo de 0.87, lo que muestra que existe una relaci칩n mucho m치s directa entre el transcurso del tiempo y el incremento del n칰mero de casos, lo que confirmar칤a lo que ve칤amos respecto a que su curva de tendencia se distanciaba al alza en relaci칩n con la de homicidios.


```{r echo=FALSE}
datos_cor <- datos_sh %>%

select (a침o_def, suicidios, homicidios)

# 2. Calcular la matriz de correlaci칩n de Pearson
# La funci칩n 'cor()' realiza el c치lculo.
matriz_correlacion <- cor(datos_cor, method = "pearson")


```
### Matriz de Correlaci칩n de Pearson

```{r echo=FALSE}
corrplot(
  corr = matriz_correlacion,        # La matriz que calculamos
  method = "circle",                # Estilo de representaci칩n (c칤rculos, cuadrados, etc.)
  type = "upper",                   # Mostrar solo la parte superior (la matriz es sim칠trica)
  tl.col = "black",                 # Color del texto de las etiquetas
  tl.srt = 45,                      # Rotar etiquetas para mejor lectura
  col = COL2("PiYG", 200),          # Paleta de colores (Rojo/Azul)
  addCoef.col = "white",            # A침adir los coeficientes num칠ricos en la gr치fica
  order = "hclust"                  # Opcional: Reordenar las variables por similitud (clustering)
)

# Imprimir la matriz de correlaci칩n para ver los valores
#print("Matriz de Correlaci칩n de Pearson:")
print(matriz_correlacion)
```

## Conclusiones y recomendaciones

### Conclusiones

   1 - La tasa de suicidios y homicidios tienden a incrementarse en Uruguay.
   
   2 - Los suicidios en el periodo se incrementaron un 122.70%.
   
   3 - Los homicidios en el periodo se incrementaron un 137.18%.
   
   4 - En cada a침o del periodo, la tasa de suicidios fue superior a la de homicidios.
   
   5 - La mayor칤a de esos a침os, la tasa de suicidios ha superado al doble de la homicidios.
   
   6 - En 2024 la raz칩n entre el n칰mero de suicidios y el de homicidios fue 1.9953. Podemos decir, el doble.
   
   7 - El homicidio es socialmente visible y libre de tab칰es, sin embargo la urgencia social entre estas dos variables se enfoca en el suicidio.
   
   8 - El crecimiento de ambos indicadores no esta directamente relacionado.
   
### Recomendaciones

   1 - El suicidio como problema social de origen multifactorial requiere se mantenga la atenci칩n sobre el mismo.
   
   2 - Si bien se concluy칩 que tanto el suicidio como el homicidio durante los primeros 7-8 a침os del periodo mantuvieron una tendencia similar no se pudo establecer una dependencia entre ambos, por lo que se recomienda continuar la l칤nea investigativa buscando terceros factores que puedan estar incidiendo en el comportamiento de cada una o ambos indicadores.
   
---